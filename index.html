<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸš‘ ë¬´ë“±ì‚° ì‚°ì•…ì‚¬ê³  ê¸°ë¡</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=ff9e145029506d6e4c72d1f2b01ea424&libraries=services"></script>

<style>
body {
  background: #f0f2f5;
  font-family: Arial, sans-serif;
  line-height: 1.6;
}

/* ì „ì²´ ë ˆì´ì•„ì›ƒ */
.container {
  max-width: 900px;
  margin: 24px auto;
  padding: 20px;
}

/* ì„¹ì…˜ ì¹´ë“œ */
.section {
  background: #ffffff;
  border-radius: 14px;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  margin-bottom: 28px;
}

/* ì„¹ì…˜ ì œëª© */
.section h2 {
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 1px solid #e5e7eb;
  color: #1e3a8a;
}

/* ì…ë ¥ ìš”ì†Œ */
input,
select,
textarea {
  border: 1px solid #cbd5e1;
  border-radius: 10px;
  padding: 12px 14px;
  width: 100%;
  margin-bottom: 16px;
  font-size: 1rem;
  background-color: #ffffff;
}

/* í¬ì»¤ìŠ¤ */
input:focus,
select:focus,
textarea:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 2px rgba(59,130,246,0.15);
}

/* í…ìŠ¤íŠ¸ ì˜ì—­ */
textarea {
  min-height: 140px;
  resize: vertical;
  line-height: 1.7;
}

/* ì¢Œí‘œ í‘œì‹œ */
.coordinate-box {
  background: #eef2ff;
  padding: 12px 14px;
  border-radius: 10px;
  margin-bottom: 12px;
  font-weight: 500;
}

/* ì§€ë„ */
#map {
  width: 100%;
  height: 320px;
  border-radius: 14px;
  margin-top: 12px;
}

/* ê¸°ë¡ í‘œì‹œ */
.board-item {
  white-space: pre-line;
  background: #f8fafc;
  padding: 16px;
  border-radius: 12px;
  line-height: 1.6;
  font-size: 0.95rem;
}

/* ë²„íŠ¼ */
button {
  font-size: 1.05rem;
}
</style>
</head>

<body>
<div class="container">

<h1 class="text-2xl font-bold text-center text-blue-700 mb-6">
ë¬´ë“±ì‚° ì‚°ì•…ì‚¬ê³  ê¸°ë¡
</h1>

<form id="recordForm">

<!-- í˜„ì¥ì •ë³´ -->
<div class="section">
<h2 class="text-xl font-semibold">í˜„ì¥ì •ë³´</h2>

<input type="datetime-local" name="ë„ì°©ì‹œê°„" required>
<input type="text" name="ì‚¬ê³ ì¥ì†Œ" placeholder="ì‚¬ê³ ì¥ì†Œ" required>
<input type="text" name="ì£¼ì¦ìƒ" placeholder="í™˜ì ì¦ìƒ" required>  
  
<div id="locationDisplay" class="coordinate-box">ìœ„ë„: , ê²½ë„:</div>
<button type="button" id="getLocation"
class="bg-green-600 text-white px-4 py-2 rounded">
ğŸŒ í˜„ì¥ë„ì°© ì¢Œí‘œ
</button>

<input type="hidden" name="ì‚¬ê³ ì¢Œí‘œ" id="hiddenCoordinate">
<div id="map"></div>


</div>

<!-- GCS -->
<div class="section">
<h2 class="text-xl font-semibold">ì˜ì‹í‰ê°€(GCS)</h2>

<select id="eye">
<option value="4">E4 ìë°œ: ìë°œì ìœ¼ë¡œ ëˆˆì„ ëœ¬ë‹¤</option>
<option value="3">E3 ìŒì„±: ë§ë¡œ ì§€ì‹œí–ˆì„ë•Œ ëˆˆì„ ëœ¬ë‹¤</option>
<option value="2">E2 í†µì¦: í†µì¦ ìê·¹ì— ì˜í•´ ëˆˆì„ ëœ¬ë‹¤</option>
<option value="1">E1 ë¬´ë°˜ì‘: ì–´ë– í•œ ìê·¹ì—ë„ ëˆˆì„ ëœ¨ì§€ ëª»í•œë‹¤</option>
</select>

<select id="verbal">
<option value="5">V5 ì§€ë‚¨ë ¥: ì •í™•í•œ ë°˜ì‘(6í•˜ì›ì¹™ì— ì§€ë‚¨ë ¥ ìˆëŠ” ìƒíƒœ)</option>
<option value="4">V4 í˜¼ë€: ëŒ€í™” í˜¼ë€(ëŒ€í™”ê°€ëŠ¥í•˜ë‚˜ ê³„ì†ì  ëŒ€í™” êµí™˜ ì•ˆë¨)</option>
<option value="3">V3 ë¶€ì ì ˆ: ì–¸ì–´í˜¼ë€(ë™ë¬¸ì„œë‹µ)</option>
<option value="2">V2 ì‹ ìŒ: ì´í•´í•  ìˆ˜ ì—†ëŠ” ì†Œë¦¬</option>
<option value="1">V1 ë¬´ë°˜ì‘: ë°˜ì‘ ì—†ìŒ</option>
</select>

<select id="motor">
<option value="6">M6 ëª…ë ¹ìˆ˜í–‰</option>
<option value="5">M5 êµ­ì†ŒíšŒí”¼</option>
<option value="4">M4 ì›€ì¸ ë¦¼</option>
<option value="3">M3 ì´ìƒêµ´ê³¡</option>
<option value="2">M2 ì´ìƒì‹ ì „</option>
<option value="1">M1 ë¬´ë°˜ì‘</option>
</select>

<div class="mt-2">
<strong>ì˜ì‹í‰ê°€(GCS) ê²°ê³¼:</strong>
<span id="gcsResult"></span>
</div>
</div>

<!-- í™˜ìì •ë³´ -->
<div class="section">
<h2 class="text-xl font-semibold">í™˜ìì •ë³´</h2>
<input type="text" name="í™˜ìì´ë¦„" placeholder="ì´ë¦„" required>
<input type="date" name="ìƒë…„ì›”ì¼" required>
<input type="text" name="ê±°ì£¼ì§€" placeholder="ê±°ì£¼ì§€" required>
</div>

<!-- ì‘ê¸‰ì²˜ì¹˜ -->
<div class="section">
<h2 class="text-xl font-semibold">ì‘ê¸‰ì²˜ì¹˜</h2>
<textarea name="ì‘ê¸‰ì²˜ì¹˜"></textarea>
</div>

<button type="submit"
class="w-full bg-blue-600 text-white py-4 rounded">
ê¸°ë¡ ì €ì¥ ë° ê³µìœ 
</button>

</form>

<div class="section">
<h2 class="text-xl font-semibold">ì‘ì„±ê¸°ë¡</h2>
<div id="savedData"></div>
</div>

</div>

<script>
const GOOGLE_SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbxm_oLeGMIGh5PRokCURztVx6-1Ijug2KtuGbsFH-cZVOKE5LgaKDnLbTgFl2sWWDdkwA/exec";

/* GCS ê³„ì‚° */
function calcGCS(){
  const t = +eye.value + +verbal.value + +motor.value;
  const s = t===15 ? "ì •ìƒ" : t>=13 ? "ì¡¸ë¦¼" : t>=9 ? "í˜¼ë¯¸" : t>=4 ? "ë°˜í˜¼ìˆ˜" : "í˜¼ìˆ˜";
  gcsResult.textContent = `${t}ì  (${s})`;
}
["eye","verbal","motor"].forEach(id => document.getElementById(id).onchange = calcGCS);
calcGCS();

/* GPS */
getLocation.onclick = () => {
  navigator.geolocation.getCurrentPosition(p => {
    const lat = p.coords.latitude;
    const lng = p.coords.longitude;
    const txt = `ìœ„ë„:${lat}, ê²½ë„:${lng}`;
    locationDisplay.textContent = txt;
    hiddenCoordinate.value = txt;

    const loc = new kakao.maps.LatLng(lat, lng);
    const map = new kakao.maps.Map(document.getElementById("map"), { center: loc, level: 3 });
    new kakao.maps.Marker({ position: loc, map });
  });
};

/* ì €ì¥ + ì „ì†¡ + ê³µìœ  */
recordForm.onsubmit = async e => {
  e.preventDefault();

  let data = {}, text = "";
  new FormData(recordForm).forEach((v,k)=>{ data[k]=v; text+=`${k}: ${v}\n`; });
  data["GCS"] = gcsResult.textContent;
  text += `GCS: ${gcsResult.textContent}`;

  savedData.innerHTML = `<div class="board-item">${text}</div>`;

  const blob = new Blob([text], {type:"text/plain"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "ë¬´ë“±ì‚°_í™˜ìê¸°ë¡.txt";
  a.click();

  fetch(GOOGLE_SCRIPT_URL,{
    method:"POST",
    body:JSON.stringify(data)
  }).catch(()=>{});

  if(navigator.share){
    navigator.share({
      title:"ë¬´ë“±ì‚° ì‚°ì•…ì‚¬ê³  ê¸°ë¡",
      text:text
    });
  }
};
</script>

</body>
</html>
